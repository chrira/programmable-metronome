{"version":3,"sources":["piece/bars.js","piece/piece.js","music/masquerade.js","metronom.js"],"names":["Bars","amount","content","module","exports","require","Piece","name","parts","length","addParts","prototype","getName","getParts","getPart","number","size","part","i","barsPart","j","part2","subPart2","k","barsSubPart2","l","barsSatz1","barsSatz2","barsSatz3","Masquerade","call","Object","create","constructor","defineProperty","value","enumerable","writable","piece","document","getElementById","addEventListener","start","stop","bars","a","v","u","takt","schlag","achtelDieserSchlag","timestamp","Date","getTime","achtelDauer","vorlauf","achtelZeigen","stopped","ersterBeep","wechsleTempo","id","neueSatzNummer","erstenBeepAusloesen","setVariables","stopTimer","run","jetztstarten","tempo","checked","satzNr","slice","startbar","splice","now","beep","setTimeout","window","clearTimeout","AudioContext","webkitAudioContext","e","alert","loud","freq","dur","createOscillator","createGain","connect","type","destination","frequency","gain","currentTime","sumArray","myArray","count"],"mappings":"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","file":"metronom.ec4d1cbc.map","sourceRoot":"../src","sourcesContent":["/**\n * bar configuration\n */\nfunction Bars(amount, content) {\n  this.amount = amount;\n  this.content = content;\n}\n\nmodule.exports = Bars;\n","/**\n * music piece base class\n */\n\nvar Bars = require('./bars');\n\nfunction Piece(name, parts) {\n  this.name = name;\n  this.parts = [parts.length];\n  this.addParts(parts);\n}\n\nPiece.prototype.getName = function() {\n  return this.name;\n}\n\nPiece.prototype.getParts = function() {\n  return this.parts.length;\n};\n\nPiece.prototype.getPart = function(number) {\n  return this.parts[number - 1];\n};\n\nPiece.prototype.addParts = function(parts) {\n  const size = parts.length;\n  var part;\n  for (var i = 0; i < size; i++) {\n    part = parts[i];\n\n    if (part instanceof Bars) {\n      // whole part is defined by Bars config\n      var barsPart = [part.amount];\n      for (var j = 0; j < part.amount; j++) {\n        barsPart[j] = part.content;\n      }\n      this.parts[i] = barsPart;\n    } else {\n      // part is an array\n      var part2 = [];\n      var subPart2;\n\n      for (var k = 0; k < part.length; k++) {\n        subPart2 = part[k];\n\n        if (subPart2 instanceof Bars) {\n          var barsSubPart2 = [subPart2.amount];\n          for (var l = 0; l < subPart2.amount; l++) {\n            part2[part2.length] = subPart2.content;\n          }\n        } else {\n          part2[part2.length] = subPart2;\n        }\n      }\n\n      this.parts[i] = part2;\n    }\n  }\n}\n\nmodule.exports = Piece;\n","var Piece = require('../piece/piece');\nvar Bars = require('../piece/bars');\n\nconst barsSatz1 = new Bars(66, [2, 2, 2, 2]);\n\nconst barsSatz2 = new Bars(75, [2, 2, 2]);\n\nconst barsSatz3 = [\n  new Bars(2, [2, 2, 2, 2]),\n  [2, 2, 2, 3],\n  new Bars(3, [2, 2, 3]),\n  [2, 2, 2, 3], [2, 2, 3], [2, 2, 2, 3], [2, 2, 3], [2, 2, 2, 3],\n  new Bars(2, [3, 3, 2]),\n  new Bars(12, [3]),\n  [2, 2, 3], [2, 2, 2, 3], [2, 2, 3], [2, 2, 2, 3], [2, 2, 3, 3],\n  new Bars(6, [3]),\n  new Bars(3, [2, 2, 3]),\n  [3, 3, 2],\n  new Bars(3, [2, 2, 3]),\n  [3, 3, 2],\n  new Bars(2, [2, 2, 3]),\n  new Bars(2, [3, 3, 3]),\n  [2, 2, 3], [2, 2, 2, 3], [2, 2, 3], [2, 2, 2, 3], [2, 2, 3], [2, 2, 2, 2, 3],\n  new Bars(4, [3]),\n  new Bars(2, [2, 2, 3]),\n  [2, 2, 3, 3],\n  new Bars(60, [3]),\n  new Bars(3, [3, 2]),\n  new Bars(62, [3]),\n  [2, 2, 3], [2, 2, 2, 3], [2, 2, 3], [2, 2, 2, 3], [2, 2, 3], [2, 2, 2, 2, 3], [2, 2, 3], [2, 2, 2, 3], [2, 2, 3], [2, 2, 2, 3],\n  new Bars(14, [3]),\n  [2, 2, 3],\n  new Bars(4, [3])\n];\n\nfunction Masquerade() {\n  Piece.call(this, \"Masquerade\", [barsSatz1, barsSatz2, barsSatz3]);\n}\n\nMasquerade.prototype = Object.create(Piece.prototype);\nMasquerade.prototype.constructor = Masquerade;\n\nObject.defineProperty(Masquerade.prototype, 'constructor', { \n  value: Masquerade, \n  enumerable: false,\n  writable: true });\n\nmodule.exports = Masquerade;\n","\"use strict\";\n\nvar Masquerade = require('./music/masquerade');\n\nvar piece = new Masquerade();\n\nvar barsSatz1 = piece.getPart(1);\nvar barsSatz2 = piece.getPart(2);\nvar barsSatz3 = piece.getPart(3);\n\ndocument.getElementById(\"startButton\").addEventListener(\"click\", start);\ndocument.getElementById(\"stopButton\").addEventListener(\"click\", stop);\n\n\n\n//var achtel = 0;\nvar takt = 0;\nvar schlag = 0;\nvar achtelDieserSchlag = 0;\nvar timestamp = (new Date()).getTime();\nvar achtelDauer = 200;\n\nvar bars;\nvar vorlauf = 0;\nvar achtelZeigen = true;\nvar stopped = false;\n\nvar ersterBeep = true;\n\nfunction wechsleTempo(id) {\n\tvar neueSatzNummer = document.getElementById(\"satz\").value;\n\n\tif (neueSatzNummer == 1) {\n\t\tdocument.getElementById(\"tempo\").value = 176;\n\t}\n\telse if (neueSatzNummer == 2) {\n\t\tdocument.getElementById(\"tempo\").value = 60;\n\t}\n\telse if (neueSatzNummer == 3) {\n\t\tdocument.getElementById(\"tempo\").value = 140;\n\t}\n}\nfunction start() {\n\tersterBeep = false;\n\terstenBeepAusloesen();\n\n\tstopped = true;\n\tsetVariables();\n\t//alert(\"start\");\n\tstopTimer();\n\tstopped = false;\n\trun();\n\t//setTimeout(jetztstarten, 5);\n}\n\nfunction jetztstarten() {\n\t//alert(\"start\");\n\tstopped = false;\n\trun();\n}\n\n\nfunction setVariables() {\n\tvar tempo = document.getElementById(\"tempo\").value;\n\tachtelDauer = (1000 * 60 / 2) / tempo;\n\n\tif (document.getElementById(\"achtelzeigen\").checked) {\n\t\tachtelZeigen = true;\n\t}\n\telse {\n\t\tachtelZeigen = false;\n\t}\n\n\tvar satzNr = document.getElementById(\"satz\").value;\n\tif (satzNr == 1) {\n\t\tbars = barsSatz1.slice(0);\n\t}\n\tif (satzNr == 2) {\n\t\tbars = barsSatz2.slice(0);\n\t}\n\tif (satzNr == 3) {\n\t\tbars = barsSatz3.slice(0);\n\t}\n\n\n\ttakt = document.getElementById(\"starttakt\").value - 1;\n\n\tvorlauf = document.getElementById(\"vorlauf\").value;\n\tvar startbar = bars[takt];\n\tfor (var i = 0; i < vorlauf; i++) {\n\t\tbars.splice(takt, 0, startbar);\n\t}\n\n\tdocument.getElementById(\"aktuellertakt\").value = takt + 1 - vorlauf;\n\n\t// reset\n\n\tschlag = 0;\n\tachtelDieserSchlag = 0;\n\ttimestamp = (new Date()).getTime();\n\n}\n\nfunction run() {\n\n\tvar now = (new Date()).getTime();\n\n\tif (now - timestamp >= achtelDauer) {\n\t\tif (schlag == 0 && achtelDieserSchlag == 0) { // erster Achtel eines Taktes\n\t\t\tbeep(10, 600, 50);\n\t\t}\n\t\telse if (achtelDieserSchlag == 0) { // erster Achtel eines Schlages\n\t\t\tbeep(10, 500, 50);\n\t\t}\n\t\telse if (achtelZeigen) { // irgendein Achtel\n\t\t\tbeep(10, 400, 50);\n\t\t}\n\t\ttimestamp = now;\n\n\t\t// hochzaehlen für nächsten Achtel\n\t\tachtelDieserSchlag++;\n\t\tif (achtelDieserSchlag >= bars[takt][schlag]) { // nicht mehr im schlag drin\n\t\t\t// neuer Schlag\n\t\t\tachtelDieserSchlag = 0;\n\t\t\tschlag++;\n\t\t\tif (schlag >= bars[takt].length) {// nicht mehr im takt drin\n\t\t\t\tschlag = 0;\n\t\t\t\ttakt++;\n\n\t\t\t\tdocument.getElementById(\"aktuellertakt\").value = takt + 1 - vorlauf;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (takt < bars.length && !stopped) {\n\t\tsetTimeout(run, 1);\n\t}\n}\n\n// Timer stoppen\nfunction stopTimer() {\n\tfor (var i = 1; i < 99999; i++) {\n\t\t//window.clearInterval(i);\n\t\twindow.clearTimeout(i);\n\t}\n}\n\nfunction stop() {\n\tstopped = true;\n}\n\n// Beep erstellen\n// https://stackoverflow.com/questions/35497243/how-to-make-a-short-beep-in-javascript-that-can-be-called-repeatedly-on-a-page#35498316\n//var a = new AudioContext();\n//var a = new webkitAudioContext();\n\nvar a;\nvar v;\nvar u;\nfunction erstenBeepAusloesen() {\n\t// Do we have Audio API\n\ttry {\n\t\twindow.AudioContext = window.AudioContext || window.webkitAudioContext;\n\t} catch (e) {\n\t\talert('Web Audio API is not supported in this browser');\n\t}\n\n\ta = new AudioContext();\n\t//v = a.createOscillator();\n\t//u = a.createGain();\n\t//v.connect(u);\n\t//v.type = \"square\";\n\t//u.connect(a.destination);\n\tbeep(1, 100, 1);\n}\n\nfunction beep(loud, freq, dur) {\n\t//var a = new AudioContext();\n\t//console.log(loud+x+y)\n\n\t// notwendig?\n\tv = a.createOscillator();\n\tu = a.createGain();\n\tv.connect(u);\n\tv.type = \"square\";\n\tu.connect(a.destination);\n\n\tv.frequency.value = freq;\n\tu.gain.value = loud * 0.01;\n\tv.start(a.currentTime);\n\tv.stop(a.currentTime + dur * 0.001);\n}\n\n// Summe in Array\n// https://stackoverflow.com/questions/3762589/fastest-javascript-summation\nfunction sumArray(myArray) {\n\tvar count = 0;\n\tfor (var i = myArray.length - 1; i > 0; i--) {\n\t\tcount += myArray[i];\n\t}\n\treturn count;\n}\n"]}